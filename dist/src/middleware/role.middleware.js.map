{"version":3,"sources":["../../../src/middleware/role.middleware.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport { AppError } from '../utils/AppError';\n\nexport const requireRole = (...roles: string[]) => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const user = (req as any).user;\n    \n    if (!user) {\n      return next(new AppError('User not authenticated', 401));\n    }\n\n    if (!roles.includes(user.role)) {\n      return next(new AppError(`Access denied. Required role: ${roles.join(' or ')}`, 403));\n    }\n\n    next();\n  };\n};"],"names":["requireRole","roles","req","res","next","user","AppError","includes","role","join"],"mappings":";;;;+BAGaA;;;eAAAA;;;0BAFY;AAElB,MAAMA,cAAc,CAAC,GAAGC;IAC7B,OAAO,CAACC,KAAcC,KAAeC;QACnC,MAAMC,OAAO,AAACH,IAAYG,IAAI;QAE9B,IAAI,CAACA,MAAM;YACT,OAAOD,KAAK,IAAIE,kBAAQ,CAAC,0BAA0B;QACrD;QAEA,IAAI,CAACL,MAAMM,QAAQ,CAACF,KAAKG,IAAI,GAAG;YAC9B,OAAOJ,KAAK,IAAIE,kBAAQ,CAAC,CAAC,8BAA8B,EAAEL,MAAMQ,IAAI,CAAC,SAAS,EAAE;QAClF;QAEAL;IACF;AACF"}